BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2723784556.55709
 ALGERIA                   |   1997 | 4665887214.18023
 ALGERIA                   |   1996 | 4675873599.64399
 ALGERIA                   |   1995 | 4664066525.89009
 ALGERIA                   |   1994 | 4637363274.63055
 ALGERIA                   |   1993 | 4649995759.73955
 ALGERIA                   |   1992 | 4679633809.94379
 ARGENTINA                 |   1998 | 2703504835.23825
 ARGENTINA                 |   1997 |  4647571360.5029
 ARGENTINA                 |   1996 | 4655130978.08001
 ARGENTINA                 |   1995 | 4650592740.65774
 ARGENTINA                 |   1994 | 4638714508.37988
 ARGENTINA                 |   1993 | 4616661238.58538
 ARGENTINA                 |   1992 | 4640293348.54152
 BRAZIL                    |   1998 |  2721334769.2468
 BRAZIL                    |   1997 | 4666448450.95162
 BRAZIL                    |   1996 | 4687060468.86436
 BRAZIL                    |   1995 | 4676001533.33908
 BRAZIL                    |   1994 | 4645063242.12228
 BRAZIL                    |   1993 | 4647053343.01572
 BRAZIL                    |   1992 | 4684913584.88963
 CANADA                    |   1998 | 2758838651.01698
 CANADA                    |   1997 | 4689099052.83879
 CANADA                    |   1996 | 4703316092.90444
 CANADA                    |   1995 | 4669697107.98872
 CANADA                    |   1994 |  4691218684.5741
 CANADA                    |   1993 | 4675600517.15544
 CANADA                    |   1992 | 4688747011.33729
 CHINA                     |   1998 |  2719473542.6993
 CHINA                     |   1997 | 4648998334.05572
 CHINA                     |   1996 | 4659315951.24331
 CHINA                     |   1995 | 4683378537.43625
 CHINA                     |   1994 | 4663332223.69908
 CHINA                     |   1993 | 4638861952.53355
 CHINA                     |   1992 | 4648960001.52098
 EGYPT                     |   1998 | 2748155847.96301
 EGYPT                     |   1997 | 4680809193.94065
 EGYPT                     |   1996 |  4698637798.8302
 EGYPT                     |   1995 | 4684425737.96421
 EGYPT                     |   1994 | 4663217949.18373
 EGYPT                     |   1993 |  4663918325.7793
 EGYPT                     |   1992 | 4687811877.72149
 ETHIOPIA                  |   1998 |  2758903217.5968
 ETHIOPIA                  |   1997 | 4696587412.67518
 ETHIOPIA                  |   1996 | 4687460580.25157
 ETHIOPIA                  |   1995 | 4665456966.05497
 ETHIOPIA                  |   1994 | 4713540551.34621
 ETHIOPIA                  |   1993 | 4696773923.89731
 ETHIOPIA                  |   1992 | 4693651235.38105
 FRANCE                    |   1998 | 2730575323.17948
 FRANCE                    |   1997 | 4649145821.75971
 FRANCE                    |   1996 |  4686974954.9225
 FRANCE                    |   1995 | 4637533345.16593
 FRANCE                    |   1994 | 4669642671.22494
 FRANCE                    |   1993 | 4670870006.76451
 FRANCE                    |   1992 | 4676214409.06031
 GERMANY                   |   1998 | 2746596816.19798
 GERMANY                   |   1997 | 4667777829.31448
 GERMANY                   |   1996 | 4680323676.92678
 GERMANY                   |   1995 | 4680966529.50341
 GERMANY                   |   1994 | 4660149366.19058
 GERMANY                   |   1993 | 4695912306.98585
 GERMANY                   |   1992 | 4682116781.58382
 INDIA                     |   1998 | 2732060040.20806
 INDIA                     |   1997 |  4637808686.4946
 INDIA                     |   1996 | 4682024343.38059
 INDIA                     |   1995 | 4654189662.45055
 INDIA                     |   1994 | 4680570854.96977
 INDIA                     |   1993 | 4659171814.63037
 INDIA                     |   1992 | 4679238238.64742
 INDONESIA                 |   1998 | 2707974135.04946
 INDONESIA                 |   1997 | 4601487688.63574
 INDONESIA                 |   1996 | 4603051013.60645
 INDONESIA                 |   1995 | 4597406148.80598
 INDONESIA                 |   1994 | 4595199194.89721
 INDONESIA                 |   1993 | 4584073249.32225
 INDONESIA                 |   1992 | 4562267147.22928
 IRAN                      |   1998 | 2706518386.24431
 IRAN                      |   1997 | 4628864096.52261
 IRAN                      |   1996 | 4597154306.32819
 IRAN                      |   1995 | 4607446673.58106
 IRAN                      |   1994 |  4633528530.6248
 IRAN                      |   1993 |  4636981047.6392
 IRAN                      |   1992 | 4632854016.48218
 IRAQ                      |   1998 |  2715527519.0089
 IRAQ                      |   1997 | 4630488760.19365
 IRAQ                      |   1996 | 4665069463.57247
 IRAQ                      |   1995 | 4602366379.32541
 IRAQ                      |   1994 | 4640615248.94991
 IRAQ                      |   1993 | 4628605014.53138
 IRAQ                      |   1992 | 4650900637.95213
 JAPAN                     |   1998 | 2716310892.55467
 JAPAN                     |   1997 | 4610162490.19403
 JAPAN                     |   1996 | 4655286576.61025
 JAPAN                     |   1995 | 4645674096.63907
 JAPAN                     |   1994 | 4619415777.03097
 JAPAN                     |   1993 | 4609025956.19386
 JAPAN                     |   1992 | 4617231121.18755
 JORDAN                    |   1998 | 2710630691.90133
 JORDAN                    |   1997 | 4612756709.11602
 JORDAN                    |   1996 |  4658569534.9691
 JORDAN                    |   1995 | 4612345132.65829
 JORDAN                    |   1994 | 4630814300.29874
 JORDAN                    |   1993 |  4639113682.8101
 JORDAN                    |   1992 | 4643476797.82925
 KENYA                     |   1998 | 2714596649.68097
 KENYA                     |   1997 | 4596577927.23628
 KENYA                     |   1996 | 4639168241.24296
 KENYA                     |   1995 | 4610500746.18606
 KENYA                     |   1994 | 4624575482.22537
 KENYA                     |   1993 | 4605793873.81422
 KENYA                     |   1992 | 4599061830.25338
 MOROCCO                   |   1998 | 2737198196.97136
 MOROCCO                   |   1997 | 4677354219.00896
 MOROCCO                   |   1996 | 4681976122.65095
 MOROCCO                   |   1995 | 4657672896.68585
 MOROCCO                   |   1994 |  4660373859.0224
 MOROCCO                   |   1993 | 4678063472.34266
 MOROCCO                   |   1992 | 4689343592.98916
 MOZAMBIQUE                |   1998 | 2712954241.27266
 MOZAMBIQUE                |   1997 | 4652055827.29316
 MOZAMBIQUE                |   1996 | 4651691648.71821
 MOZAMBIQUE                |   1995 | 4660747725.48097
 MOZAMBIQUE                |   1994 | 4639109449.32607
 MOZAMBIQUE                |   1993 | 4639242269.22166
 MOZAMBIQUE                |   1992 | 4652845808.90445
 PERU                      |   1998 | 2710121815.41237
 PERU                      |   1997 | 4648535581.74849
 PERU                      |   1996 | 4641100682.60027
 PERU                      |   1995 | 4641610760.88601
 PERU                      |   1994 | 4634232295.32025
 PERU                      |   1993 | 4646925129.33002
 PERU                      |   1992 | 4667150246.39347
 ROMANIA                   |   1998 | 2747885799.18486
 ROMANIA                   |   1997 | 4684523865.26185
 ROMANIA                   |   1996 | 4690731658.22772
 ROMANIA                   |   1995 | 4677280201.46687
 ROMANIA                   |   1994 | 4667309969.44558
 ROMANIA                   |   1993 | 4699251304.06161
 ROMANIA                   |   1992 | 4674627067.45974
 RUSSIA                    |   1998 | 2722275470.37502
 RUSSIA                    |   1997 | 4643297637.28786
 RUSSIA                    |   1996 | 4641054826.01564
 RUSSIA                    |   1995 | 4602585148.48007
 RUSSIA                    |   1994 | 4615506999.89977
 RUSSIA                    |   1993 | 4646490171.82904
 RUSSIA                    |   1992 | 4618310575.11805
 SAUDI ARABIA              |   1998 | 2713715702.37125
 SAUDI ARABIA              |   1997 | 4633879045.72114
 SAUDI ARABIA              |   1996 | 4641508180.87708
 SAUDI ARABIA              |   1995 | 4650578300.82944
 SAUDI ARABIA              |   1994 | 4647036473.45071
 SAUDI ARABIA              |   1993 | 4638302210.86973
 SAUDI ARABIA              |   1992 | 4637959710.93714
 UNITED KINGDOM            |   1998 | 2718906607.15285
 UNITED KINGDOM            |   1997 | 4667175971.84667
 UNITED KINGDOM            |   1996 | 4686130946.62296
 UNITED KINGDOM            |   1995 | 4652996056.93692
 UNITED KINGDOM            |   1994 | 4674530476.29843
 UNITED KINGDOM            |   1993 | 4654095904.71663
 UNITED KINGDOM            |   1992 | 4666250811.34392
 UNITED STATES             |   1998 | 2724307107.84304
 UNITED STATES             |   1997 | 4676673488.24424
 UNITED STATES             |   1996 | 4691659033.14116
 UNITED STATES             |   1995 | 4654666723.12449
 UNITED STATES             |   1994 | 4688622910.40091
 UNITED STATES             |   1993 | 4706695471.20959
 UNITED STATES             |   1992 | 4682453010.09186
 VIETNAM                   |   1998 | 2733777877.68569
 VIETNAM                   |   1997 | 4649783337.82727
 VIETNAM                   |   1996 |  4654314561.8551
 VIETNAM                   |   1995 | 4667037959.51182
 VIETNAM                   |   1994 | 4667604827.07945
 VIETNAM                   |   1993 | 4664717554.93308
 VIETNAM                   |   1992 | 4677057645.16694
(175 rows)

COMMIT;
COMMIT
