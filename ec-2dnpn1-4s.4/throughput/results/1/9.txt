BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%floral%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2728525304.26763
 ALGERIA                   |   1997 | 4653783486.69994
 ALGERIA                   |   1996 |  4673790699.4353
 ALGERIA                   |   1995 | 4644833429.24927
 ALGERIA                   |   1994 |  4660237640.8611
 ALGERIA                   |   1993 | 4633646412.08558
 ALGERIA                   |   1992 | 4674734580.94175
 ARGENTINA                 |   1998 | 2705808518.81753
 ARGENTINA                 |   1997 | 4591737313.32995
 ARGENTINA                 |   1996 | 4625551874.36919
 ARGENTINA                 |   1995 | 4638769267.54508
 ARGENTINA                 |   1994 |  4616881281.1245
 ARGENTINA                 |   1993 | 4612586707.54076
 ARGENTINA                 |   1992 | 4628299231.05194
 BRAZIL                    |   1998 | 2744596660.41239
 BRAZIL                    |   1997 | 4657245732.41146
 BRAZIL                    |   1996 | 4696612398.68085
 BRAZIL                    |   1995 |  4651500402.4223
 BRAZIL                    |   1994 | 4653717567.78786
 BRAZIL                    |   1993 | 4678539274.67474
 BRAZIL                    |   1992 | 4664499332.38368
 CANADA                    |   1998 | 2736271236.62443
 CANADA                    |   1997 |  4657136094.2465
 CANADA                    |   1996 | 4652807718.87074
 CANADA                    |   1995 | 4651668487.56095
 CANADA                    |   1994 | 4644957553.76903
 CANADA                    |   1993 |  4647041627.1048
 CANADA                    |   1992 | 4659645776.70313
 CHINA                     |   1998 | 2711758153.50585
 CHINA                     |   1997 |  4638922498.6509
 CHINA                     |   1996 | 4650079151.62655
 CHINA                     |   1995 | 4669457592.96665
 CHINA                     |   1994 | 4663543314.28124
 CHINA                     |   1993 |  4633730970.3273
 CHINA                     |   1992 | 4644712956.13788
 EGYPT                     |   1998 | 2721570405.91595
 EGYPT                     |   1997 | 4634778830.11701
 EGYPT                     |   1996 |  4672322277.6121
 EGYPT                     |   1995 | 4657675986.02177
 EGYPT                     |   1994 | 4616206423.98926
 EGYPT                     |   1993 | 4642305961.38063
 EGYPT                     |   1992 | 4649439774.08239
 ETHIOPIA                  |   1998 | 2749878993.14209
 ETHIOPIA                  |   1997 | 4666922616.05276
 ETHIOPIA                  |   1996 | 4659131158.46896
 ETHIOPIA                  |   1995 |  4672392051.9328
 ETHIOPIA                  |   1994 | 4667615704.75603
 ETHIOPIA                  |   1993 | 4657815883.80683
 ETHIOPIA                  |   1992 | 4670753237.00948
 FRANCE                    |   1998 | 2710581253.87435
 FRANCE                    |   1997 | 4664785000.49179
 FRANCE                    |   1996 | 4670196257.79123
 FRANCE                    |   1995 |  4653818969.4578
 FRANCE                    |   1994 | 4644241937.65228
 FRANCE                    |   1993 | 4654637828.05037
 FRANCE                    |   1992 | 4666478719.94208
 GERMANY                   |   1998 | 2722814262.44821
 GERMANY                   |   1997 | 4643171649.79897
 GERMANY                   |   1996 | 4637642280.02882
 GERMANY                   |   1995 | 4647774890.85431
 GERMANY                   |   1994 | 4649006777.58751
 GERMANY                   |   1993 | 4629636890.03186
 GERMANY                   |   1992 | 4661437746.65903
 INDIA                     |   1998 | 2707302832.05121
 INDIA                     |   1997 | 4634276101.21369
 INDIA                     |   1996 | 4654053043.57237
 INDIA                     |   1995 | 4617758915.22538
 INDIA                     |   1994 | 4604493279.18291
 INDIA                     |   1993 | 4626726333.04687
 INDIA                     |   1992 | 4637048857.05039
 INDONESIA                 |   1998 | 2726732579.88319
 INDONESIA                 |   1997 | 4616677023.36026
 INDONESIA                 |   1996 | 4631743813.27687
 INDONESIA                 |   1995 | 4617264922.05628
 INDONESIA                 |   1994 | 4625435646.54912
 INDONESIA                 |   1993 | 4628004361.01096
 INDONESIA                 |   1992 | 4631948717.40377
 IRAN                      |   1998 | 2695053476.18233
 IRAN                      |   1997 |  4612101517.3525
 IRAN                      |   1996 | 4633362602.33382
 IRAN                      |   1995 | 4616627538.98044
 IRAN                      |   1994 | 4634895497.19036
 IRAN                      |   1993 | 4615371746.95913
 IRAN                      |   1992 | 4661620088.21971
 IRAQ                      |   1998 | 2704558811.60908
 IRAQ                      |   1997 | 4628827261.59302
 IRAQ                      |   1996 | 4634155419.33254
 IRAQ                      |   1995 | 4638203489.57525
 IRAQ                      |   1994 | 4651360817.04483
 IRAQ                      |   1993 | 4620665014.74456
 IRAQ                      |   1992 | 4656604229.50687
 JAPAN                     |   1998 | 2711048068.81584
 JAPAN                     |   1997 |  4623036253.4369
 JAPAN                     |   1996 | 4646046161.82346
 JAPAN                     |   1995 | 4630005238.16622
 JAPAN                     |   1994 | 4644356083.22076
 JAPAN                     |   1993 | 4611454160.96554
 JAPAN                     |   1992 | 4637502998.33737
 JORDAN                    |   1998 | 2707277072.62477
 JORDAN                    |   1997 | 4629942526.19541
 JORDAN                    |   1996 | 4632405180.15323
 JORDAN                    |   1995 | 4608578396.41269
 JORDAN                    |   1994 | 4620962456.59022
 JORDAN                    |   1993 | 4631151619.77215
 JORDAN                    |   1992 | 4613043925.85949
 KENYA                     |   1998 |  2704572939.5446
 KENYA                     |   1997 | 4611456123.30042
 KENYA                     |   1996 | 4627115710.33086
 KENYA                     |   1995 | 4614763709.42893
 KENYA                     |   1994 | 4615466789.29324
 KENYA                     |   1993 | 4594611177.66763
 KENYA                     |   1992 | 4624731122.24022
 MOROCCO                   |   1998 | 2726174591.26217
 MOROCCO                   |   1997 | 4663192803.60899
 MOROCCO                   |   1996 | 4666472677.05667
 MOROCCO                   |   1995 |  4663409018.4629
 MOROCCO                   |   1994 | 4657977359.21962
 MOROCCO                   |   1993 | 4651800290.55839
 MOROCCO                   |   1992 | 4673849728.98883
 MOZAMBIQUE                |   1998 | 2708330967.50513
 MOZAMBIQUE                |   1997 | 4643927602.54323
 MOZAMBIQUE                |   1996 | 4674221947.04173
 MOZAMBIQUE                |   1995 | 4641916211.50568
 MOZAMBIQUE                |   1994 | 4643027949.87899
 MOZAMBIQUE                |   1993 | 4621026225.71897
 MOZAMBIQUE                |   1992 | 4645541272.91545
 PERU                      |   1998 |  2710604321.9775
 PERU                      |   1997 | 4618774312.32513
 PERU                      |   1996 | 4647877411.54321
 PERU                      |   1995 | 4603918577.90043
 PERU                      |   1994 | 4602745363.21672
 PERU                      |   1993 | 4632972673.64114
 PERU                      |   1992 | 4619324833.48053
 ROMANIA                   |   1998 | 2712641773.75008
 ROMANIA                   |   1997 | 4634838017.74664
 ROMANIA                   |   1996 | 4651782536.90365
 ROMANIA                   |   1995 | 4645687244.74792
 ROMANIA                   |   1994 | 4654422771.77351
 ROMANIA                   |   1993 | 4650991824.42286
 ROMANIA                   |   1992 | 4652494649.97184
 RUSSIA                    |   1998 | 2711123319.18937
 RUSSIA                    |   1997 | 4649611524.12882
 RUSSIA                    |   1996 | 4629807597.60909
 RUSSIA                    |   1995 | 4626641587.36158
 RUSSIA                    |   1994 | 4625966188.11728
 RUSSIA                    |   1993 | 4623481775.76943
 RUSSIA                    |   1992 | 4659015606.05349
 SAUDI ARABIA              |   1998 | 2693464474.15559
 SAUDI ARABIA              |   1997 | 4629147090.46756
 SAUDI ARABIA              |   1996 | 4650374051.52059
 SAUDI ARABIA              |   1995 | 4636165849.45967
 SAUDI ARABIA              |   1994 | 4637701689.56548
 SAUDI ARABIA              |   1993 | 4636620209.83747
 SAUDI ARABIA              |   1992 | 4646706421.73505
 UNITED KINGDOM            |   1998 | 2737701191.54051
 UNITED KINGDOM            |   1997 | 4675813719.28745
 UNITED KINGDOM            |   1996 | 4687341915.11128
 UNITED KINGDOM            |   1995 | 4673041466.60742
 UNITED KINGDOM            |   1994 | 4664028223.16411
 UNITED KINGDOM            |   1993 | 4656638034.77457
 UNITED KINGDOM            |   1992 | 4696865875.84207
 UNITED STATES             |   1998 | 2713643794.82125
 UNITED STATES             |   1997 | 4654745703.32898
 UNITED STATES             |   1996 | 4665142693.69153
 UNITED STATES             |   1995 | 4636357319.60076
 UNITED STATES             |   1994 | 4640089025.46868
 UNITED STATES             |   1993 | 4628684833.93604
 UNITED STATES             |   1992 | 4655627358.25212
 VIETNAM                   |   1998 |  2731698206.3937
 VIETNAM                   |   1997 | 4645774773.41082
 VIETNAM                   |   1996 | 4678505704.06243
 VIETNAM                   |   1995 | 4676756300.86412
 VIETNAM                   |   1994 | 4656611517.92373
 VIETNAM                   |   1993 |  4658648022.8826
 VIETNAM                   |   1992 | 4669717214.34502
(175 rows)

COMMIT;
COMMIT
